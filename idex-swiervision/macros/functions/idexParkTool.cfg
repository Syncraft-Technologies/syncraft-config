[gcode_macro _idexParkTool]
gcode = 
	{% set dcvars = printer["gcode_macro DC_VARS"] %}
	SAVE_GCODE_STATE NAME=park_tool
	SET_GCODE_OFFSET X=0 Y=0 Z=0
	G90
	{% if printer.dual_carriage.carriage_0 == 'PRIMARY' %}
		{% set extruderLeftPositionX = printer.configfile.settings.stepper_x.position_endstop|float + 0.75 %}
		G1 X{extruderLeftPositionX} F{dcvars.feedrate}
	{% elif printer.dual_carriage.carriage_1 == 'PRIMARY' %}
		{% set extruderRightPositionX = printer.configfile.settings.dual_carriage.position_endstop|float - 0.75 %}
		G1 X{extruderRightPositionX} F{dcvars.feedrate}
	{% else %}
		RESPOND TYPE=error MSG={ "Unknown extruder: %s".format(printer.toolhead.extruder) }
	{% endif %}
	
    {% if dcvars.y_scrub <= 295 %}
		SET_GCODE_VARIABLE MACRO=DC_VARS VARIABLE=y_scrub VALUE=295
	{% else %}
		SET_GCODE_VARIABLE MACRO=DC_VARS VARIABLE=y_scrub VALUE={dcvars.y_scrub - 1}
	{% endif %}
	SAVE_VARIABLE VARIABLE=y_scrub VALUE={dcvars.y_scrub}
	RESTORE_GCODE_STATE NAME=park_tool
	
	RESPOND TYPE=echo MSG="_idexParkTool inside"
	M400 # Wait for all movements to finish